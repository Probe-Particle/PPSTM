g++ -std=c++11 -O3 -ffast-math -ftree-vectorize  -c -fPIC ProbeSTM_spd.cpp
g++ -std=c++11 -O3 -ffast-math -ftree-vectorize  -shared -Wl,-soname,ProbeSTM_spd_lib.so -o ProbeSTM_spd_lib.so ProbeSTM_spd.o
g++ -std=c++11 -O3 -ffast-math -ftree-vectorize  -c -fPIC IO.cpp
g++ -std=c++11 -O3 -ffast-math -ftree-vectorize  -shared -Wl,-soname,IO_lib.so -o IO_lib.so IO.o
Importing libraries
 PACKAGE_PATH =  /home/foxcatcher/Desktop/pavel/stm/PPSTM/pyPPSTM
 CPP_PATH     =  /home/foxcatcher/Desktop/pavel/stm/PPSTM/cpp
 ProbeParticle Library DIR =  /home/foxcatcher/Desktop/pavel/stm/PPSTM/pyPPSTM
DEBUG: OMP_NUM_THREADS not defined - serial calculations
DEBUG: make_name STM
 ProbeParticle Library DIR =  /home/foxcatcher/Desktop/pavel/stm/PPSTM/pyPPSTM
DEBUG: make_name IO
Libraries imported
 skipped line :  

DEBUG: geom_plot [['H', 'H', 'H', 'H'], [3.141593, 4.141593, 5.141593, 6.141593], [0.367879, 0.367879, 0.367879, 0.367879], [1.414214, 1.414214, 1.414214, 1.414214], [9.9e-08, -1.06e-07, -1.27e-07, 1.34e-07]]
Preparing the scan grid for fixed scan
Grid has dimensios:  (1, 201, 341, 3)
scan grids prepared
Reading electronic & geometry structure files
reading FHI-AIMS LCAO coefficients for basis:  sp
[[0.        0.        0.        0.3333333]
 [0.3925    0.        0.        0.3333333]
 [0.785     0.        0.        0.3333333]] 3 <type 'numpy.ndarray'> 4
kaka: [[0.     0.     0.    ]
 [0.3925 0.     0.    ]
 [0.785  0.     0.    ]]
weights: [0.3333333 0.3333333 0.3333333] 0.3333333
len(kaka) 3
<type 'numpy.ndarray'>
 # ============ define atoms ============
 skipped line :  

DEBUG: struct: [[3.141593 0.367879 1.414214]
 [4.141593 0.367879 1.414214]
 [5.141593 0.367879 1.414214]
 [6.141593 0.367879 1.414214]] 3 3.141593
4
 Number of atoms:  4
Applying PBC
dx 0.0
dy 0.0
dx 4.0
dy 0.0
dx 8.0
dy 0.0
dx 12.0
dy 0.0
dx 16.0
dy 0.0
 Number of atoms after PBC:  20
atomic geometry read
Ratin [[-4.858407  0.367879  1.414214]
 [-3.858407  0.367879  1.414214]
 [-2.858407  0.367879  1.414214]
 [-1.858407  0.367879  1.414214]
 [-0.858407  0.367879  1.414214]
 [ 0.141593  0.367879  1.414214]
 [ 1.141593  0.367879  1.414214]
 [ 2.141593  0.367879  1.414214]
 [ 3.141593  0.367879  1.414214]
 [ 4.141593  0.367879  1.414214]
 [ 5.141593  0.367879  1.414214]
 [ 6.141593  0.367879  1.414214]
 [ 7.141593  0.367879  1.414214]
 [ 8.141593  0.367879  1.414214]
 [ 9.141593  0.367879  1.414214]
 [10.141593  0.367879  1.414214]
 [11.141593  0.367879  1.414214]
 [12.141593  0.367879  1.414214]
 [13.141593  0.367879  1.414214]
 [14.141593  0.367879  1.414214]]
The Fermi Level:  -5.12847821993  eV; in FHI-AIMS is the Fermi automatically 0.
eigen-energies read
 loading the LCAO coefficients with k-points
coefIm: [[[ 4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
  [-4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [-1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]]

 [[ 9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]
  [-9.0768e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [-0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]]]
DEBUG coefRe.shape, coefIm.shape (2, 4, 4) (2, 4, 4)
coefRe [[[-1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 4.6102e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
  [-4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00]]

 [[ 0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]
  [-9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [-0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00]]]
coeffsIm.shape: (2, 16)
coeffsIm before going to do pbc:  [[ 4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00  1.0000e-05  0.0000e+00
   0.0000e+00  0.0000e+00 -4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00
  -1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
 [ 9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00
   0.0000e+00  0.0000e+00 -9.0768e-01  0.0000e+00  0.0000e+00  0.0000e+00
  -0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]]
[[0.     0.     0.    ]
 [0.3925 0.     0.    ]
 [0.785  0.     0.    ]]
[[3.141593 0.367879 1.414214]
 [4.141593 0.367879 1.414214]
 [5.141593 0.367879 1.414214]
 [6.141593 0.367879 1.414214]]
coefReNew.shape (2, 4, 4)
coefImNew.shape (2, 4, 4)
coefReNew [[[-1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 4.6102e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
  [-4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00]]

 [[ 0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]
  [-9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [-0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00]]]
coefImNew [[[ 4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]
  [-4.6103e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [-1.0000e-05  0.0000e+00  0.0000e+00  0.0000e+00]]

 [[ 9.0767e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [ 0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]
  [-9.0768e-01  0.0000e+00  0.0000e+00  0.0000e+00]
  [-0.0000e+00  0.0000e+00  0.0000e+00  0.0000e+00]]]
len eig 2
8
eigNew: [-4.09878178  5.78470822 -4.09878178  5.78470822 -4.09878178  5.78470822
 -4.09878178  5.78470822] -4.09878178007 5.78470821993
applying pbc to coefficients...
no. atom:  0
kDotR 1.2330752525 cos 0.331337760177
[-1.10445909e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
no. atom:  1
kDotR 1.6255752525 cos -0.0547515336812
[-0.00841385 -0.         -0.         -0.        ]
no. atom:  2
kDotR 2.0180752525 cos -0.432513743376
[-1.44171233e-06 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
no. atom:  3
kDotR 2.4105752525 cos -0.744495542902
[ 0.11441158 -0.         -0.         -0.        ]
no. atom:  0
kDotR 1.2330752525 cos 0.331337760177
[0. 0. 0. 0.]
no. atom:  1
kDotR 1.6255752525 cos -0.0547515336812
[ 0.01656544 -0.         -0.         -0.        ]
no. atom:  2
kDotR 2.0180752525 cos -0.432513743376
[ 0. -0. -0. -0.]
no. atom:  3
kDotR 2.4105752525 cos -0.744495542902
[-0.22525207 -0.         -0.         -0.        ]
no. atom:  0
part2 [-3.14504038e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
no. atom:  1
part2 [0.15344281 0.         0.         0.        ]
no. atom:  2
part2 [3.00542417e-06 0.00000000e+00 0.00000000e+00 0.00000000e+00]
no. atom:  3
part2 [-0.10259875  0.          0.          0.        ]
no. atom:  0
part2 [0. 0. 0. 0.]
no. atom:  1
part2 [-0.3021028  0.         0.         0.       ]
no. atom:  2
part2 [-0.  0.  0.  0.]
no. atom:  3
part2 [0.20199511 0.         0.         0.        ]
no. atom:  0
part3 [0.05091888 0.         0.         0.        ]
no. atom:  1
part3 [-1.82505094e-07 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
no. atom:  2
part3 [ 0.06646726 -0.         -0.         -0.        ]
no. atom:  3
part3 [ 2.48165156e-06 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
no. atom:  0
part3 [0.10024844 0.         0.         0.        ]
no. atom:  1
part3 [-0. -0. -0. -0.]
no. atom:  2
part3 [ 0.13086135 -0.         -0.         -0.        ]
no. atom:  3
part3 [ 0. -0. -0. -0.]
no. atom:  0
part4 [0.1449958 0.        0.        0.       ]
no. atom:  1
part4 [3.32833303e-06 0.00000000e+00 0.00000000e+00 0.00000000e+00]
no. atom:  2
part4 [-0.13855907  0.          0.          0.        ]
no. atom:  3
part4 [-2.22542455e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
no. atom:  0
part4 [0.28546588 0.         0.         0.        ]
no. atom:  1
part4 [0. 0. 0. 0.]
no. atom:  2
part4 [-0.27279634  0.          0.          0.        ]
no. atom:  3
part4 [-0.  0.  0.  0.]
DEBUG: combinedCoefz [[[-1.10445909e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-8.41384984e-03 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [-1.44171233e-06 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [ 1.14411582e-01 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]]

 [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [ 1.65654399e-02 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [ 0.00000000e+00 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [-2.25252067e-01 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]]

 [[-3.14504038e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [ 1.53442809e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [ 3.00542417e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-1.02598748e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]]

 [[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-3.02102804e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [ 2.01995110e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]]

 [[ 5.09188774e-02  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-1.82505094e-07 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [ 6.64672637e-02 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [ 2.48165156e-06 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]]

 [[ 1.00248438e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-0.00000000e+00 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [ 1.30861345e-01 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]
  [ 0.00000000e+00 -0.00000000e+00 -0.00000000e+00 -0.00000000e+00]]

 [[ 1.44995797e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [ 3.32833303e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-1.38559070e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-2.22542455e-06  0.00000000e+00  0.00000000e+00  0.00000000e+00]]

 [[ 2.85465880e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-2.72796341e-01  0.00000000e+00  0.00000000e+00  0.00000000e+00]
  [-0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00]]]
combinedCoefz.shape (8, 4, 4)
